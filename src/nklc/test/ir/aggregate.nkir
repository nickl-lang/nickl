extern "c" printf
extern "m" sqrt

type Vec2 :{[2]f64}

local proc Vec2_length(:Vec2 %vec) :f64 {
    load [%vec] -> :f64 %x
    add %vec, 8 -> %y_addr
    load [%y_addr] -> :f64 %y
    mul :f64 %x, %x -> %x
    mul :f64 %y, %y -> %y
    add :f64 %x, %y -> %len2
    call sqrt, (:f64 %len2) -> :f64 %len
    ret %len
}

pub proc _entry() {
    call Vec2_length, (:Vec2 {[1.2, 3.4]}) -> :f64 %len
    call printf, ("%lf\n", ..., :f64 %len) -> :i32
    ret
}

/* @output
3.605551

@endoutput */
