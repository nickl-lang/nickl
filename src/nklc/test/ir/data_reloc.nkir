extern "c" $printf

type String :{ i64, u64 }

// local const $str_data :{ [14]i8 } {"Hello, World!"}
local const $str_data :{ [14]i8 } {[ 72, 101, 108, 108, 111, 44, 32, 87, 111, 114, 108, 100, 33, 0, ]}
local const $str :String {$str_data, 14}

pub proc $_entry() {
    load [$str] -> :i64 %data

    add $str, 8 -> %sz_ptr
    load [%sz_ptr] -> :u64 %sz64
    trunc :u64 %sz64 -> :u32 %sz32

    call $printf, ("%.*s\n", ..., :u32 %sz32, :i64 %data) -> :i32

    ret
}

/* @output
Hello, World!

@endoutput */
