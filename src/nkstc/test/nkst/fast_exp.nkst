(const printf () (extern_c_proc [(param () (ptr (i8))) ("...")] (i32)))

(const main () (proc [(param argc (i32)) (param argv (ptr (ptr (i8))))] (i32) [
    (call printf ["%zi^%zi=%zi\n" BASE EXP (call fast_exp [BASE EXP])])
    (return 0)
]))

(const fast_exp () (proc [(param _x (i64)) (param _n (i64))] (i64) [
    (var x () _x)
    (var n () _n)

    (var a () 1)

    (while (ne n 0) [
        (if (ne (bitand n 1) 0) [
            (assign a (mul a x))
        ] ())
        (assign n (rsh n 1))
        (assign x (mul x x))
    ])

    (return a)
]))

(const BASE () 2)
(const EXP () 24)

(call main [0 (nullptr)])

/* @output
2^24=16777216

@endoutput */
