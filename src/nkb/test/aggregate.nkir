proc extern printf(i64, ...) i32
proc extern sqrt(f64) f64

type Vec2: { [2]f64 }

proc Vec2_length(vec: Vec2) f64 {
@start
    tmp: f64
    len_squared: f64
    mul vec+0:f64, vec+0:f64 -> len_squared
    mul vec+8:f64, vec+8:f64 -> tmp
    add len_squared, tmp -> len_squared
    call sqrt, (len_squared) -> ret
    ret
}

proc main(argc: i32, argv: i64) i32 {
@start
    len: f64

    // TODO Implement consts
    vec: Vec2
    mov 1.2 -> vec+0:f64
    mov 3.4 -> vec+8:f64

    call Vec2_length, (vec) -> len
    call printf, ("%lf\n", len)
    mov  0 -> ret
    ret
}

/* @output
3.605551

@endoutput */
